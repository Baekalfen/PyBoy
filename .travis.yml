language: generic

matrix:
  include:
    - os: linux
      dist: bionic
    - os: osx
      osx_image: xcode11.3

compiler:
  - gcc
  - clang

addons:
  apt:
    packages:
      - libsdl2-dev
      - build-essential
      - python3
      - python3-pip
      - python3-dev

before_install:
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew update ; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew install sdl2; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew unlink python@2; fi
  # - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew upgrade python3; fi

install: make build

script: make test_no_clean

deploy:
  provider: pypi
  distributions: "sdist bdist_wheel"
  on:
    branch: master
    tags: true
